# Перемножение матриц

## Ссылка на google colab:

https://colab.research.google.com/drive/1dnB_QnJWAWnp-H7CUjfw3zxkfCeLRQVN?usp=sharing


## Описание реализации:

Данная программа содержит две функции, отвечающие за перемножение матриц и функцию проверки:
* execute_cpu; функция перемножения матриц на CPU, на вход подаются три массива: 
входные и выходная матрица, а также размерность данных матриц (во внимание принимаются квадратные матрицы).
Данная функция позволяет осуществлять выделение памяти и умножение матриц на CPU.
* execute_gpu; функция перемножения матриц на GPU с использованием технологии CUDA,
на вход подаются три массива (входные матрицы и выходная), их размерность, а также количество блоков в гриде и количество 
нитей в блоке. Функция выделяет память на GPU, затем пересылает данные с хоста на девайс, после чего вызывается ядро с определенными параметрами,
в ядре происходит параллельная обработка матриц. Суммарное число нитей позволяет каждой нити обработать один элемент выходного массива.
После конца обработки (вызывается функция синхронизации устройств), полученная выходная матрица отправляется обратно на хост.
* check_matrix; функция проверки корректности перемножения.

На CPU время перемножения матриц считается с использованием функции clock(),
на GPU - с использованием событий (cudaEventRecord) и с использованием функции измерения времени выполнения (cudaEventElapsedTime), которая подсчитывает время между ивентами.

## Почему было распараллелено:

Программа на CPU выполняет последовательный код,
программа, использующая GPU, позволяет выполнять параллельную обработку.
GPU содержит сотни вычислительных ядер и поддержку миллионов виртуальных нитей.
Благодаря этому в определенных ситуациях использование параллельных программ позволяет сократить время выполнения во много раз.
В данном случае при обработке матриц большой размерности имеет смысл реализовывать программу на GPU, отправляя данные массивов
на девайс и параллельно обрабатывая все элементы матрицы.

## Таблица с данными об эксперименте.

| Размерность матриц  | Время выполнения на CPU  | Время выполнения на GPU| Ускорение |
|:------------------- |:------------------------:|:----------------------:| ---------:|
| 100x100             | 0,005024                 | 0,000176               | 28,5      |
| 200x200             | 0,024751                 | 0,000677               | 36,5      |
| 400x400             | 0,261520                 | 0,006001               | 43,58     |
| 800x800             | 2,166051                 | 0,047755               | 43,36     |
| 1600x1600           | 44,136984                | 0,266160               | 165,8     |
| 2000x2000           | 97,085982                | 0,455107               | 213,3     |

# Ссылка на графики:
https://docs.google.com/spreadsheets/d/1r61RXWK9qDwtav7RHqm9qpJkalcg7LAuKiiGC0AFUf0/edit?usp=sharing
